{"ast":null,"code":"import _asyncToGenerator from\"/Users/yardentsaraf/Desktop/EpicureApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/yardentsaraf/Desktop/EpicureApp/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/yardentsaraf/Desktop/EpicureApp/node_modules/@babel/runtime/regenerator/index.js\";import Input from\"../layout/form/Input\";import\"./User.scss\";import{Link}from\"react-router-dom\";import{Fragment,useEffect,useState}from\"react\";import Footer from\"../footer/Footer\";import Header from\"../header/Header\";import SubmitButton from\"../layout/button/SubmitButton\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SignIn=function SignIn(){var _useState=useState(),_useState2=_slicedToArray(_useState,2),usernameInputs=_useState2[0],setUsernameInputs=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),passwordInputs=_useState4[0],setPasswordInputs=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),feedback=_useState6[0],setFeedback=_useState6[1];var handleChangeUsername=function handleChangeUsername(e){setUsernameInputs(e.target.value);};var handleChangePassword=function handleChangePassword(e){setPasswordInputs(e.target.value);};var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_context.prev=1;_context.next=4;return axios.post(\"http://localhost:8080/auth/signin\",{username:usernameInputs,password:passwordInputs});case 4:result=_context.sent;if(result.data.token)localStorage.setItem(\"token\",result.data.token);setFeedback(\"Logged in successfuly\");document.location.href=\"http://localhost:3000/\";_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](1);setFeedback(_context.t0.response.data||\"Network error. try again\");case 13:case\"end\":return _context.stop();}}},_callee,null,[[1,10]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();var isLoggedIn=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var token,result;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:token=localStorage.getItem(\"token\");_context2.prev=1;_context2.next=4;return axios.get(\"http://localhost:8080/auth/\",{headers:{\"auth-token\":token}});case 4:result=_context2.sent;_context2.next=10;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](1);localStorage.removeItem(\"token\");case 10:case\"end\":return _context2.stop();}}},_callee2,null,[[1,7]]);}));return function isLoggedIn(){return _ref2.apply(this,arguments);};}();useEffect(function(){var token=localStorage.getItem(\"token\");if(token)isLoggedIn();},[]);return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Sign In\"}),/*#__PURE__*/_jsx(Input,{content:\"Username \",placeholder:\"Please Enter Your Username\",type:\"text\",onChange:function onChange(e){return handleChangeUsername(e);},value:usernameInputs,minLength:2,maxLength:8}),/*#__PURE__*/_jsx(Input,{content:\"Password \",placeholder:\"Please Enter Your Password\",type:\"password\",onChange:function onChange(e){return handleChangePassword(e);},value:passwordInputs,minLength:2,maxLength:8}),/*#__PURE__*/_jsx(SubmitButton,{onClick:function onClick(e){return handleSubmit(e);}}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Don't have an account yet? \",/*#__PURE__*/_jsx(Link,{to:\"/signup\",children:\"Sign Up\"})]}),/*#__PURE__*/_jsx(\"b\",{children:feedback})]}),/*#__PURE__*/_jsx(Footer,{})]});};export default SignIn;","map":{"version":3,"sources":["/Users/yardentsaraf/Desktop/EpicureApp/src/components/user/SignIn.tsx"],"names":["Input","Link","Fragment","useEffect","useState","Footer","Header","SubmitButton","axios","SignIn","usernameInputs","setUsernameInputs","passwordInputs","setPasswordInputs","feedback","setFeedback","handleChangeUsername","e","target","value","handleChangePassword","handleSubmit","preventDefault","post","username","password","result","data","token","localStorage","setItem","document","location","href","response","isLoggedIn","getItem","get","headers","removeItem"],"mappings":"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","sourcesContent":["import Input from \"../layout/form/Input\";\nimport \"./User.scss\";\nimport { Link } from \"react-router-dom\";\nimport { Fragment, useEffect, useState } from \"react\";\nimport Footer from \"../footer/Footer\";\nimport Header from \"../header/Header\";\nimport SubmitButton from \"../layout/button/SubmitButton\";\nimport axios from \"axios\";\n\n\nconst SignIn = () => {\n\n  const [usernameInputs, setUsernameInputs] = useState()\n  const [passwordInputs, setPasswordInputs] = useState()\n\n  const [feedback, setFeedback] = useState(\"\")\n\n  const handleChangeUsername = (e: any) => {\n    setUsernameInputs(e.target.value)\n  }\n  const handleChangePassword = (e: any) => {\n    setPasswordInputs(e.target.value)\n  }\n  const handleSubmit = async (e: React.FormEvent<HTMLInputElement>)=> {\n    e.preventDefault()\n    try {\n    const result = await axios.post(\"http://localhost:8080/auth/signin\", {username: usernameInputs, password: passwordInputs})\n    if(result.data.token) localStorage.setItem(\"token\", result.data.token)\n    setFeedback(\"Logged in successfuly\")\n    document.location.href = \"http://localhost:3000/\"\n    }\n    catch(err: any) {\n      setFeedback(err.response.data || \"Network error. try again\")\n    }\n  }\n\n  const isLoggedIn = async () => {\n    const token: any = localStorage.getItem(\"token\")\n    try {\n    const result = await axios.get(\"http://localhost:8080/auth/\", {\n      headers: {\n        \"auth-token\": token\n      }\n    })\n    } catch(err) {\n    localStorage.removeItem(\"token\")\n  }\n  }\n\n  useEffect(() => {\n    const token = localStorage.getItem(\"token\")\n    if(token) isLoggedIn()\n  }, [])\n\n  return (\n    <Fragment>\n      <Header />\n      <form>\n        <h2>Sign In</h2>\n        <Input\n          content={\"Username \"}\n          placeholder={\"Please Enter Your Username\"}\n          type={\"text\"}\n          onChange={(e:any) => handleChangeUsername(e)}\n          value={usernameInputs}\n          minLength={2}\n          maxLength={8}\n        ></Input>\n        <Input\n          content={\"Password \"}\n          placeholder={\"Please Enter Your Password\"}\n          type={\"password\"}\n          onChange={(e:any) => handleChangePassword(e)}\n          value={passwordInputs}\n          minLength={2}\n          maxLength={8}\n        ></Input>\n        <SubmitButton onClick={(e:any) => handleSubmit(e)}/>\n        <p>\n          Don't have an account yet? <Link to=\"/signup\">Sign Up</Link>\n        </p>\n        <b>{feedback}</b>\n      </form>\n      <Footer />\n    </Fragment>\n  );\n};\n\nexport default SignIn;\n"]},"metadata":{},"sourceType":"module"}